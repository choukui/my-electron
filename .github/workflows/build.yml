on:
    push:
        branches:
          - master

jobs:
    release:
        name: build and release electron app
        runs-on: ${{ matrix.os }}
        
        strategy:
            fail-fast: false
            matrix:
              os: [windows-latest]

        steps:
            - name: Check out git repository
              uses: actions/checkout@v3.5.3

            - name: Install Node.js
              uses: actions/setup-node@v3.0.0
              with:
                node-version: "16"

            - name: Install Dependencies
              run: npm install

            - name: Build Electron App
              run: npm run make

            - name: Create Release Pull Request or Publish
              id: changesets
              uses: changesets/action@v1
              with:
                # 执行更新版本和发布的命令
                version: npm exec changeset version
                publish: npm exec changeset publish
              env:
                # 这里需要几个 Token 变量
                # GITHUB_TOKEN 是 CI 里自带的默认 token
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            
  
            
